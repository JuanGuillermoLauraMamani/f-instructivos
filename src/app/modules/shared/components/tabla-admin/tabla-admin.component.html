<ion-header [translucent]="true" class="ion-no-border">
  <ion-toolbar>
    <ion-item>
      <ion-title>Instructivos</ion-title>
      <ion-button size="default" color="tertiary" (click)="openFormulario()">
        <ion-icon slot="start" name="document"></ion-icon>
        Agregar
      </ion-button>
    </ion-item>
  </ion-toolbar>
</ion-header>
<div class="ion-padding">
  <table datatable [dtOptions]="dtOptions" *ngIf="instructivos.length>0">
    <thead>
      <tr>
        <td>ID</td>
        <td>Nombre</td>
        <td>Versi√≥n</td>
        <td>Vigencia</td>
        <td>Fecha Inicio</td>
        <td>Fecha Fin</td>
        <td>Tipo</td>
        <td>PDF Original</td>
        <td>PDF Escaneado</td>
        <td>Tiempo</td>
        <td>Acciones</td>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let inst of instructivos">
        <td>{{ inst.id_instructivo }}</td>
        <td>{{ inst.nombre }}</td>
        <td>{{ inst.version }}</td>
        <td>
          <ion-badge color="{{inst.vigencia? 'success' : 'danger' }}">{{ inst.vigencia ? "Vigente" : "No vigente" }}</ion-badge>
        </td>
        <td>{{ inst.fecha_inicio }}</td>
        <td>{{ inst.vigencia !== true ? inst.fecha_fin : "-" }}</td>
        <td>{{inst.tipo}}</td>
        <td>
          <ion-button size="small" (click)="open(inst, 'http://127.0.0.1:5000/instructivos_originales/'+inst.id_instructivo+'.pdf')">
            <ion-icon name="eye-outline" size="small"></ion-icon>
          </ion-button>
        </td>
        <td>
          <ion-button size="small" (click)="open(inst, 'http://127.0.0.1:5000/instructivos_escaneados/'+inst.id_instructivo+'.pdf')">
            <ion-icon name="eye-outline" size="small"></ion-icon>
          </ion-button>
        </td>
        <td>
            <ion-icon name="timer-outline"></ion-icon>
            {{ restarFechas(inst.fecha_inicio) }}
        </td>
        <td>
          <ion-button fill="clear" color="dark" id="{{inst.id_instructivo}}" size="small">
            <ion-icon name="ellipsis-vertical-outline"></ion-icon>
          </ion-button>
          <ion-popover trigger="{{ inst.id_instructivo }}" [showBackdrop]="false">
            <ng-template>
              <ion-content>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
                <ion-list>
                  <ion-item [button]="true" [detail]="false" (click) = "openInstructivo(inst)">
                    Editar instructivo 
                  </ion-item>
                  <ion-item [button]="true" [detail]="false">
                    Anular instructivo 
                  </ion-item>    
                </ion-list>
              </ion-content>
            </ng-template>
          </ion-popover>
        </td>
      </tr>
    </tbody>
  </table>
</div>
<div *ngIf="instructivos.length===0" class="ion-padding">
  <ion-text color="danger">
    <h2>No existen instructivos cargados</h2>
  </ion-text>
</div> 
